/**********************************************************************************************************
*                                               PWM
*                                           Manejo de PWM
*
*						<Copyright>
*
*						<Copyright or distribution terms>
*
*
*********************************************************************************************************/

/*********************************************************************************************************
*                                               FW_PWMIit.c
*
* Filename	: FW_PWMIit.c
* Version	: 1.0.0					
* Programmer(s) : NEF
**********************************************************************************************************
*  Note(s):
*
*
*
*********************************************************************************************************/

/*********************************************************************************************************
 *
 * \file		FW_PWMIit.c
 * \brief		Manejo de PWM
 * \date		1 de octubre de 2019
 * \author		Nicolas Ferragamo nferragamo@est.frba.utn.edu.ar
 * \version     1.0.0
*********************************************************************************************************/

/*********************************************************************************************************
 *** INCLUDES
*********************************************************************************************************/

#include <xc.h>
#include "PWM.h"

/*********************************************************************************************************
 *** DEFINES PRIVADOS AL MODULO
*********************************************************************************************************/

/*********************************************************************************************************
 *** MACROS PRIVADAS AL MODULO
*********************************************************************************************************/

/*********************************************************************************************************
 *** TIPOS DE DATOS PRIVADOS AL MODULO
*********************************************************************************************************/

/*********************************************************************************************************
 *** TABLAS PRIVADAS AL MODULO
*********************************************************************************************************/

/*********************************************************************************************************
 *** VARIABLES GLOBALES PUBLICAS
*********************************************************************************************************/

/*********************************************************************************************************
 *** VARIABLES GLOBALES PRIVADAS AL MODULO
*********************************************************************************************************/

/*********************************************************************************************************
 *** PROTOTIPO DE FUNCIONES PRIVADAS AL MODULO
*********************************************************************************************************/

/*********************************************************************************************************
 *** FUNCIONES PRIVADAS AL MODULO
*********************************************************************************************************/

/*********************************************************************************************************
 *** FUNCIONES GLOBALES AL MODULO
*********************************************************************************************************/


/**
	\fn  		void PWM_Init (void);
	\brief 		Inicializa los registros necesarios para usar PWM
 	\author 	Nombre
 	\date 		${date}
 	\param [in] 	void
 	\param [out] 	void
*/
void PWM_Init (void)
{ 
    PR2                = 0x00;      //PWM_Perior=[PR2+1]*4*Tosc*(TMR2 Preescaler)
    CCPR1L=0;                       //Duty=(CCPR1L:CCP1CON<5:4>)*TOSC*(TMR2 Preescaler)
    CCP1CONbits.DC1B1  = 0;
    CCP1CONbits.DC1B0  = 1;
    TRISCbits.RC2      = 0;         //Salida de PWM RC2 activada
    T2CONbits.TMR2ON   = 1;         //Timer 2 encendido
    CCP1CONbits.CCP1M3 = 1;
    CCP1CONbits.CCP1M2 = 1;
}